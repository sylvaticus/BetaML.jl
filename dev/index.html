<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Index · BetaML.jl Documentation</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-JYKX8QY5JW"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JYKX8QY5JW', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">BetaML.jl Documentation</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Index</a><ul class="internal"><li><a class="tocitem" href="#About"><span>About</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Available-modules"><span>Available modules</span></a></li><li><a class="tocitem" href="#models_list"><span>Available models</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Quick-examples"><span>Quick examples</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="tutorials/Betaml_tutorial_getting_started.html">Getting started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Classification - cars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Classification - cars/betaml_tutorial_classification_cars.html">A classification task when labels are known - determining the country of origin of cars given the cars characteristics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Regression - bike sharing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Regression - bike sharing/betaml_tutorial_regression_sharingBikes.html">A regression task: the prediction of  bike  sharing demand</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Clustering - Iris</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Clustering - Iris/betaml_tutorial_cluster_iris.html">A clustering task: the prediction of  plant species from floreal measures (the iris dataset)</a></li></ul></li></ul></li><li><span class="tocitem">API (Reference manual)</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">API V2 (current)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="Api_v2_user.html">Introduction for user</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">For developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="Api_v2_developer.html">API implementation</a></li><li><a class="tocitem" href="StyleGuide_templates.html">Style guide</a></li></ul></li><li><a class="tocitem" href="Api.html">The Api module</a></li></ul></li><li><a class="tocitem" href="Perceptron.html">Perceptron</a></li><li><a class="tocitem" href="Trees.html">Trees</a></li><li><a class="tocitem" href="Nn.html">Nn</a></li><li><a class="tocitem" href="Clustering.html">Clustering</a></li><li><a class="tocitem" href="GMM.html">GMM</a></li><li><a class="tocitem" href="Imputation.html">Imputation</a></li><li><a class="tocitem" href="Utils.html">Utils</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sylvaticus/BetaML.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation"><a class="docs-heading-anchor" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation"><img src="assets/BetaML_logo_30x30.png" alt="BLogos"/> BetaML.jl Documentation</a><a id="![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation" title="Permalink"></a></h1><p>Welcome to the documentation of the <a href="https://github.com/sylvaticus/BetaML.jl"><em>Beta Machine Learning toolkit</em></a>.</p><h2 id="About"><a class="docs-heading-anchor" href="#About">About</a><a id="About-1"></a><a class="docs-heading-anchor-permalink" href="#About" title="Permalink"></a></h2><p>The <code>BetaML</code> toolkit provides machine learning algorithms written in the Julia programming language.</p><p>Aside the algorithms themselves, <code>BetaML</code> provides many &quot;utility&quot; functions. Because algorithms are all self-contained in the library itself (you are invited to explore their source code by typing <code>@edit functionOfInterest(par1,par2,...)</code>), the utility functions have APIs that are coordinated with the algorithms, facilitating the &quot;preparation&quot; of the data for the analysis, the choice of the hyper-parameters or the evaluation of the models. Most models have an interface for the <a href="https://github.com/alan-turing-institute/MLJ.jl"><code>MLJ</code></a> framework.</p><p>Aside Julia, BetaML can be accessed in R or Python using respectively <a href="https://github.com/Non-Contradiction/JuliaCall">JuliaCall</a> and <a href="https://github.com/JuliaPy/pyjulia">PyJulia</a>. See <a href="tutorials/Betaml_tutorial_getting_started.html#using_betaml_from_other_languages">the tutorial</a> for details.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The BetaML package is included in the standard Julia register, install it with:</p><ul><li><code>] add BetaML</code></li></ul><h2 id="Available-modules"><a class="docs-heading-anchor" href="#Available-modules">Available modules</a><a id="Available-modules-1"></a><a class="docs-heading-anchor-permalink" href="#Available-modules" title="Permalink"></a></h2><p>While <code>BetaML</code> is split in several (sub)modules, all of them are re-exported at the root module level. This means that you can access their functionality by simply typing <code>using BetaML</code>:</p><pre><code class="language-julia hljs">using BetaML
myLayer = DenseLayer(2,3) # DenseLayer is defined in the Nn submodule
res     = KernelPerceptronClassifier() # KernelPerceptronClassifier is defined in the Perceptron module
@edit DenseLayer(2,3)     # Open a text editor with to the relevant source code</code></pre><p>Each module is documented on the links below (you can also use the inline Julia help system: just press the question mark <code>?</code> and then, on the special help prompt <code>help?&gt;</code>, type the function name):</p><ul><li><a href="Perceptron.html"><strong><code>BetaML.Perceptron</code></strong></a>: The Perceptron, Kernel Perceptron and PegasosClassifier classification algorithms;</li><li><a href="Trees.html"><strong><code>BetaML.Trees</code></strong></a>: The Decision Trees and Random Forests algorithms for classification or regression (with missing values supported);</li><li><a href="Nn.html"><strong><code>BetaML.Nn</code></strong></a>: Implementation of Artificial Neural Networks;</li><li><a href="Clustering.html"><strong><code>BetaML.Clustering</code></strong></a>: (hard) Clustering algorithms (KMeans, KMdedoids)</li><li><a href="GMM.html"><strong><code>BetaML.GMM</code></strong></a>: Various algorithms (Clustering, regressor, missing imputation / collaborative filtering / recommandation systems) that use a Generative (Gaussian) mixture models (probabilistic) fitter, fitted using a EM algorithm;</li><li><a href="Imputation.html"><strong><code>BetaML.Imputation</code></strong></a>: Imputation algorithms;</li><li><a href="Utils.html"><strong><code>BetaML.Utils</code></strong></a>: Various utility functions (scale, one-hot, distances, kernels, pca, accuracy/error measures..).</li></ul><h2 id="models_list"><a class="docs-heading-anchor" href="#models_list">Available models</a><a id="models_list-1"></a><a class="docs-heading-anchor-permalink" href="#models_list" title="Permalink"></a></h2><p>Currently BetaML provides the following models:</p><table><tr><th style="text-align: right"><code>BetaML</code> name</th><th style="text-align: right"><a href="https://github.com/alan-turing-institute/MLJ.jl"><code>MLJ</code></a> Interface</th><th style="text-align: right">Category*</th></tr><tr><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.PerceptronClassifier"><code>PerceptronClassifier</code></a></td><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.LinearPerceptron"><code>LinearPerceptron</code></a></td><td style="text-align: right"><em>Supervised classifier</em></td></tr><tr><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.KernelPerceptronClassifier"><code>KernelPerceptronClassifier</code></a></td><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.KernelPerceptron"><code>KernelPerceptron</code></a></td><td style="text-align: right"><em>Supervised classifier</em></td></tr><tr><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.PegasosClassifier"><code>PegasosClassifier</code></a></td><td style="text-align: right"><a href="Perceptron.html#BetaML.Perceptron.Pegasos"><code>Pegasos</code></a></td><td style="text-align: right"><em>Supervised classifier</em></td></tr><tr><td style="text-align: right"><a href="Trees.html#BetaML.Trees.DecisionTreeEstimator"><code>DecisionTreeEstimator</code></a></td><td style="text-align: right"><a href="Trees.html#BetaML.Trees.DecisionTreeClassifier"><code>DecisionTreeClassifier</code></a>, <a href="Trees.html#BetaML.Trees.DecisionTreeRegressor"><code>DecisionTreeRegressor</code></a></td><td style="text-align: right"><em>Supervised regressor and classifier</em></td></tr><tr><td style="text-align: right"><a href="Trees.html#BetaML.Trees.RandomForestEstimator"><code>RandomForestEstimator</code></a></td><td style="text-align: right"><a href="Trees.html#BetaML.Trees.RandomForestClassifier"><code>RandomForestClassifier</code></a>, <a href="Trees.html#BetaML.Trees.RandomForestRegressor"><code>RandomForestRegressor</code></a></td><td style="text-align: right"><em>Supervised regressor and classifier</em></td></tr><tr><td style="text-align: right"><a href="Nn.html#BetaML.Nn.NeuralNetworkEstimator"><code>NeuralNetworkEstimator</code></a></td><td style="text-align: right"><a href="Nn.html#BetaML.Nn.NeuralNetworkRegressor"><code>NeuralNetworkRegressor</code></a>, <a href="Nn.html#BetaML.Nn.MultitargetNeuralNetworkRegressor"><code>MultitargetNeuralNetworkRegressor</code></a>, <a href="Nn.html#BetaML.Nn.NeuralNetworkClassifier"><code>NeuralNetworkClassifier</code></a></td><td style="text-align: right"><em>Supervised regressor and classifier</em></td></tr><tr><td style="text-align: right"><a href="GMM.html#BetaML.GMM.GMMRegressor1"><code>GMMRegressor1</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Supervised regressor</em></td></tr><tr><td style="text-align: right"><a href="GMM.html#BetaML.GMM.GMMRegressor2"><code>GMMRegressor2</code></a></td><td style="text-align: right"><a href="GMM.html#BetaML.GMM.GaussianMixtureRegressor"><code>GaussianMixtureRegressor</code></a>, <a href="GMM.html#BetaML.GMM.MultitargetGaussianMixtureRegressor"><code>MultitargetGaussianMixtureRegressor</code></a></td><td style="text-align: right"><em>Supervised regressor</em></td></tr><tr><td style="text-align: right"><a href="Clustering.html#BetaML.Clustering.KMeansClusterer"><code>KMeansClusterer</code></a></td><td style="text-align: right"><a href="Clustering.html#BetaML.Clustering.KMeans"><code>KMeans</code></a></td><td style="text-align: right"><em>Unsupervised hard clusterer</em></td></tr><tr><td style="text-align: right"><a href="Clustering.html#BetaML.Clustering.KMedoidsClusterer"><code>KMedoidsClusterer</code></a></td><td style="text-align: right"><a href="Clustering.html#BetaML.Clustering.KMedoids"><code>KMedoids</code></a></td><td style="text-align: right"><em>Unsupervised hard clusterer</em></td></tr><tr><td style="text-align: right"><a href="GMM.html#BetaML.GMM.GMMClusterer"><code>GMMClusterer</code></a></td><td style="text-align: right"><a href="GMM.html#BetaML.GMM.GaussianMixtureClusterer"><code>GaussianMixtureClusterer</code></a></td><td style="text-align: right"><em>Unsupervised soft clusterer</em></td></tr><tr><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.FeatureBasedImputer"><code>FeatureBasedImputer</code></a></td><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.SimpleImputer"><code>SimpleImputer</code></a></td><td style="text-align: right"><em>Unsupervised missing data imputer</em></td></tr><tr><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.GMMImputer"><code>GMMImputer</code></a></td><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.GaussianMixtureImputer"><code>GaussianMixtureImputer</code></a></td><td style="text-align: right"><em>Unsupervised missing data imputer</em></td></tr><tr><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.RFImputer"><code>RFImputer</code></a></td><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.RandomForestImputer"><code>RandomForestImputer</code></a></td><td style="text-align: right"><em>Unsupervised missing data imputer</em></td></tr><tr><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.UniversalImputer"><code>UniversalImputer</code></a></td><td style="text-align: right"><a href="Imputation.html#BetaML.Imputation.GeneralImputer"><code>GeneralImputer</code></a></td><td style="text-align: right"><em>Unsupervised missing data imputer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.MinMaxScaler"><code>MinMaxScaler</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Data transformer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.StandardScaler"><code>StandardScaler</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Data transformer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.Scaler"><code>Scaler</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Data transformer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.PCA"><code>PCA</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Unsupervised dimensionality reduction</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.OneHotEncoder"><code>OneHotEncoder</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Data transformer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.OrdinalEncoder"><code>OrdinalEncoder</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Data transformer</em></td></tr><tr><td style="text-align: right"><a href="Utils.html#BetaML.Utils.ConfusionMatrix"><code>ConfusionMatrix</code></a></td><td style="text-align: right"></td><td style="text-align: right"><em>Predictions assessment</em></td></tr></table><p>* There is no formal distinction in <code>BetaML</code> between a transformer, or also a model to assess predictions, and a unsupervised model. They are all treated as unsupervised models that given some data they lern how to return some useful information, wheter a class grouping, a specific tranformation or a quality evaluation..</p><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>New to BetaML or even to Julia / Machine Learning altogether? <a href="tutorials/Betaml_tutorial_getting_started.html#getting_started">Start from the tutorial</a>!</p><p>All models supports the (a) model <strong>construction</strong> (where hyperparameters and options are choosen), (b) <strong>fitting</strong>  and (c) <strong>prediction</strong> paradigm. A few model support <code>inverse_transform</code>, for example to go back from the one-hot encoded columns to the original categorical variable (factor). </p><p>This paradigm is described in detail in the <a href="Api_v2_user.html#api_usage"><code>API V2</code></a> page.</p><h2 id="Quick-examples"><a class="docs-heading-anchor" href="#Quick-examples">Quick examples</a><a id="Quick-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-examples" title="Permalink"></a></h2><p><em>(see the</em> <a href="tutorials/Betaml_tutorial_getting_started.html#getting_started">tutorial</a> <em>for a more step-by-step guide to the examples below and to other examples)</em></p><ul><li><strong>Using an Artificial Neural Network for multinomial categorisation</strong></li></ul><p>In this example we see how to train a neural networks model to predict the specie&#39;s name (5th column) given floral sepals and petals measures (first 4 columns) in the famous <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">iris flower dataset</a>.</p><pre><code class="language-julia hljs"># Load Modules
using DelimitedFiles, Random
using Pipe, Plots, BetaML # Load BetaML and other auxiliary modules
Random.seed!(123);  # Fix the random seed (to obtain reproducible results).

# Load the data
iris     = readdlm(joinpath(dirname(Base.find_package(&quot;BetaML&quot;)),&quot;..&quot;,&quot;test&quot;,&quot;data&quot;,&quot;iris.csv&quot;),&#39;,&#39;,skipstart=1)
x        = convert(Array{Float64,2}, iris[:,1:4])
y        = convert(Array{String,1}, iris[:,5])
# Encode the categories (levels) of y using a separate column per each category (aka &quot;one-hot&quot; encoding) 
ohmod    = OneHotEncoder()
y_oh     = fit!(ohmod,y) 
# Split the data in training/testing sets
((xtrain,xtest),(ytrain,ytest),(ytrain_oh,ytest_oh)) = partition([x,y,y_oh],[0.8,0.2])
(ntrain, ntest) = size.([xtrain,xtest],1)

# Define the Artificial Neural Network model
l1   = DenseLayer(4,10,f=relu) # The activation function is `ReLU`
l2   = DenseLayer(10,3)        # The activation function is `identity` by default
l3   = VectorFunctionLayer(3,f=softmax) # Add a (parameterless  include(&quot;Imputation_tests.jl&quot;)) layer whose activation function (`softmax` in this case) is defined to all its nodes at once
mynn = NeuralNetworkEstimator(layers=[l1,l2,l3],loss=crossentropy,descr=&quot;Multinomial logistic regression Model Sepal&quot;, batch_size=2, epochs=200) # Build the NN and use the cross-entropy as error function.
# Alternatively, swith to hyperparameters auto-tuning with `autotune=true` instead of specify `batch_size` and `epoch` manually

# Train the model (using the ADAM optimizer by default)
res = fit!(mynn,fit!(Scaler(),xtrain),ytrain_oh) # Fit the model to the (scaled) data

# Obtain predictions and test them against the ground true observations
ŷtrain         = @pipe predict(mynn,fit!(Scaler(),xtrain)) |&gt; inverse_predict(ohmod,_)  # Note the scaling and reverse one-hot encoding functions
ŷtest          = @pipe predict(mynn,fit!(Scaler(),xtest))  |&gt; inverse_predict(ohmod,_) 
train_accuracy = accuracy(ŷtrain,ytrain) # 0.975
test_accuracy  = accuracy(ŷtest,ytest)   # 0.96

# Analyse model performances
cm = ConfusionMatrix()
fit!(cm,ytest,ŷtest)
print(cm)</code></pre><pre><code class="language-text hljs">A ConfusionMatrix BetaMLModel (fitted)

-----------------------------------------------------------------

*** CONFUSION MATRIX ***

Scores actual (rows) vs predicted (columns):

4×4 Matrix{Any}:
 &quot;Labels&quot;       &quot;virginica&quot;    &quot;versicolor&quot;   &quot;setosa&quot;
 &quot;virginica&quot;   8              1              0
 &quot;versicolor&quot;  0             14              0
 &quot;setosa&quot;      0              0              7
Normalised scores actual (rows) vs predicted (columns):

4×4 Matrix{Any}:
 &quot;Labels&quot;       &quot;virginica&quot;   &quot;versicolor&quot;   &quot;setosa&quot;
 &quot;virginica&quot;   0.888889      0.111111       0.0
 &quot;versicolor&quot;  0.0           1.0            0.0
 &quot;setosa&quot;      0.0           0.0            1.0

 *** CONFUSION REPORT ***

- Accuracy:               0.9666666666666667
- Misclassification rate: 0.033333333333333326
- Number of classes:      3

  N Class      precision   recall  specificity  f1score  actual_count  predicted_count
                             TPR       TNR                 support                  

  1 virginica      1.000    0.889        1.000    0.941            9               8
  2 versicolor     0.933    1.000        0.938    0.966           14              15
  3 setosa         1.000    1.000        1.000    1.000            7               7

- Simple   avg.    0.978    0.963        0.979    0.969
- Weigthed avg.    0.969    0.967        0.971    0.966</code></pre><pre><code class="language-julia hljs">ϵ = info(mynn)[&quot;lossPerEpoch&quot;]
plot(1:length(ϵ),ϵ, ylabel=&quot;epochs&quot;,xlabel=&quot;error&quot;,legend=nothing,title=&quot;Avg. error per epoch on the Sepal dataset&quot;)
heatmap(info(cm)[&quot;categories&quot;],info(cm)[&quot;categories&quot;],info(cm)[&quot;normalised_scores&quot;],c=cgrad([:white,:blue]),xlabel=&quot;Predicted&quot;,ylabel=&quot;Actual&quot;, title=&quot;Confusion Matrix&quot;)</code></pre><p><img src="assets/sepal_errorsPerEpoch.png" alt="results"/> <img src="assets/sepal_confusionMatrix.png" alt="results"/></p><ul><li><strong>Using Random forests for regression</strong></li></ul><p>In this example we predict, using <a href="https://archive-beta.ics.uci.edu/ml/datasets/auto+mpg">another classical ML dataset</a>, the miles per gallon of various car models.</p><p>Note in particular:</p><ul><li>(a) how easy it is in Julia to import remote data, even cleaning them without ever saving a local file on disk;</li><li>(b) how Random Forest models can directly work on data with missing values, categorical one and non-numerical one in general without any preprocessing </li></ul><pre><code class="language-julia hljs"># Load modules
using Random, HTTP, CSV, DataFrames, BetaML, Plots
import Pipe: @pipe
Random.seed!(123)

# Load data
urlData = &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data&quot;
data = @pipe HTTP.get(urlData).body                                                       |&gt;
             replace!(_, UInt8(&#39;\t&#39;) =&gt; UInt8(&#39; &#39;))                                       |&gt;
             CSV.File(_, delim=&#39; &#39;, missingstring=&quot;?&quot;, ignorerepeated=true, header=false) |&gt;
             DataFrame;

# Preprocess data
X = Matrix(data[:,2:8]) # cylinders, displacement, horsepower, weight, acceleration, model year, origin, model name
y = data[:,1]           # miles per gallon
(xtrain,xtest),(ytrain,ytest) = partition([X,y],[0.8,0.2])

# Model definition, hyper-parameters auto-tuning, training and prediction
m      = RandomForestEstimator(autotune=true)
ŷtrain = fit!(m,xtrain,ytrain) # shortcut for `fit!(m,xtrain,ytrain); ŷtrain = predict(x,xtrain)`
ŷtest  = predict(m,xtest)

# Prediction assessment
relative_mean_error_train = relative_mean_error(ytrain,ŷtrain) # 0.039
relative_mean_error_test  = relative_mean_error(ytest,ŷtest)   # 0.076
scatter(ytest,ŷtest,xlabel=&quot;Actual&quot;,ylabel=&quot;Estimated&quot;,label=nothing,title=&quot;Est vs. obs MPG (test set)&quot;)</code></pre><p><img src="assets/mpg_EstVsObs.png" alt="results"/></p><ul><li><strong>Further examples</strong></li></ul><p>Finally, you may want to give a look at the <a href="https://github.com/sylvaticus/BetaML.jl/tree/master/test">&quot;test&quot; folder</a>. While the primary objective of the scripts under the &quot;test&quot; folder is to provide automatic testing of the BetaML toolkit, they can also be used to see how functions should be called, as virtually all functions provided by BetaML are tested there.</p><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>The development of this package at the <em>Bureau d&#39;Economie Théorique et Appliquée</em> (BETA, Nancy) was supported by the French National Research Agency through the <a href="http://mycor.nancy.inra.fr/ARBRE/">Laboratory of Excellence ARBRE</a>, a part of the “Investissements d&#39;Avenir” Program (ANR 11 – LABX-0002-01).</p><p><a href="hhttp://www.beta-umr7522.fr/"><img src="assets/logos_betaumr.png" alt="BLogos"/></a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/Betaml_tutorial_getting_started.html">Getting started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 9 May 2023 10:30">Tuesday 9 May 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

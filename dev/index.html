<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Index · BetaML.jl Documentation</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-JYKX8QY5JW"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JYKX8QY5JW', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">BetaML.jl Documentation</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Index</a><ul class="internal"><li><a class="tocitem" href="#About"><span>About</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Loading-the-module(s)"><span>Loading the module(s)</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Quick-examples"><span>Quick examples</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="tutorials/Betaml_tutorial_getting_started.html">Getting started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Regression - bike sharing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Regression - bike sharing/betaml_tutorial_regression_sharingBikes.html">A regression task: the prediction of  bike  sharing demand</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Classification - cars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Classification - cars/betaml_tutorial_classification_cars.html">A classification task when labels are known - determining the country of origin of cars given the cars characteristics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Clustering - Iris</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Clustering - Iris/betaml_tutorial_cluster_iris.html">A clustering task: the prediction of  plant species from floreal measures (the iris dataset)</a></li></ul></li></ul></li><li><span class="tocitem">API (Reference manual)</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">API V2 (current testing)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="Api_v2_user.html">Introduction for user</a></li><li><a class="tocitem" href="Api_v2_developer.html">For developers</a></li></ul></li><li><a class="tocitem" href="Perceptron.html">Perceptron</a></li><li><a class="tocitem" href="Trees.html">Trees</a></li><li><a class="tocitem" href="Nn.html">Nn</a></li><li><a class="tocitem" href="Clustering.html">Clustering</a></li><li><a class="tocitem" href="GMM.html">GMM</a></li><li><a class="tocitem" href="Imputation.html">Imputation</a></li><li><a class="tocitem" href="Utils.html">Utils</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sylvaticus/BetaML.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation"><a class="docs-heading-anchor" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation"><img src="assets/BetaML_logo_30x30.png" alt="BLogos"/> BetaML.jl Documentation</a><a id="![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#![BLogos](assets/BetaML_logo_30x30.png)-BetaML.jl-Documentation" title="Permalink"></a></h1><p>Welcome to the documentation of the <a href="https://github.com/sylvaticus/BetaML.jl"><em>Beta Machine Learning toolkit</em></a>.</p><h2 id="About"><a class="docs-heading-anchor" href="#About">About</a><a id="About-1"></a><a class="docs-heading-anchor-permalink" href="#About" title="Permalink"></a></h2><p>The <code>BetaML</code> toolkit provides classical algorithms written in the Julia programming language useful to &quot;learn&quot; the relationship between some inputs and some outputs, with the objective to make accurate predictions of the output given new inputs (&quot;supervised machine learning&quot;) or to better understand the structure of the data, perhaps hidden because of the high dimensionality (&quot;unsupervised machine learning&quot;).</p><p>While specific packages exist for state-of-the art implementations of these algorithms (see the section &quot;<a href="https://github.com/sylvaticus/BetaML.jl#alternative-packages">Alternative Packages</a>&quot;), thanks to the Just-In-Time compilation nature of Julia, <code>BetaML</code> is reasonably fast for datasets that fit in memory while keeping both the code and the usage as <em>simple</em> as possible.</p><p>Aside the algorithms themselves, <code>BetaML</code> provides many &quot;utility&quot; functions. Because algorithms are all self-contained in the library itself (you are invited to explore their source code by typing <code>@edit functionOfInterest(par1,par2,...)</code>), the utility functions have APIs that are coordinated with the algorithms, facilitating the &quot;preparation&quot; of the data for the analysis, the evaluation of the models or the implementation of several models in chains (pipelines). While <code>BetaML</code> doesn&#39;t provide itself tools for hyper-parameters optimisation or complex pipeline building tools, most models have an interface for the <a href="https://github.com/alan-turing-institute/MLJ.jl"><code>MLJ</code></a> framework that allows it.</p><p>Aside Julia, BetaML can be accessed in R or Python using respectively <a href="https://github.com/Non-Contradiction/JuliaCall">JuliaCall</a> and <a href="https://github.com/JuliaPy/pyjulia">PyJulia</a>. See <a href="tutorials/Betaml_tutorial_getting_started.html#using_betaml_from_other_languages">the tutorial</a> for details.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The BetaML package is included in the standard Julia register, install it with:</p><ul><li><code>] add BetaML</code></li></ul><h2 id="Loading-the-module(s)"><a class="docs-heading-anchor" href="#Loading-the-module(s)">Loading the module(s)</a><a id="Loading-the-module(s)-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-the-module(s)" title="Permalink"></a></h2><p>This package is split in several submodules, but all modules are re-exported at the root module level. This means that you can access their functionality by simply <code>using BetaML</code>.</p><pre><code class="language-julia hljs">using BetaML
myLayer = DenseLayer(2,3) # DenseLayer is defined in the Nn submodule
res     = kernelPerceptron([1.1 2.1; 5.3 4.2; 1.8 1.7], [-1,1,-1]) # kernelPerceptron is defined in the Perceptron module
@edit DenseLayer(2,3)     # Open a text editor with to the relevant source code</code></pre><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>New to BetaML or even to Julia / Machine Learning altogether? <a href="tutorials/Betaml_tutorial_getting_started.html#getting_started">Start from the tutorial</a>!</p><p>Detailed documentation for most algorithms can be retrieved using the inline Julia help system (just press the question mark <code>?</code> and then, on the special help prompt <code>help?&gt;</code>, type the function name) or on these pages under the section &quot;Api (Reference Manual)&quot; for the individual modules:</p><ul><li><a href="Perceptron.html"><strong><code>BetaML.Perceptron</code></strong></a>: The Perceptron, Kernel Perceptron and Pegasos classification algorithms;</li><li><a href="Trees.html"><strong><code>BetaML.Trees</code></strong></a>: The Decision Trees and Random Forests algorithms for classification or regression (with missing values supported);</li><li><a href="Nn.html"><strong><code>BetaML.Nn</code></strong></a>: Implementation of Artificial Neural Networks;</li><li><a href="Clustering.html"><strong><code>BetaML.Clustering</code></strong></a>: (hard) Clustering algorithms (Kmeans, Mdedoids</li><li><a href="GMM.html"><strong><code>BetaML.GMM</code></strong></a>: Various algorithms (Clustering, regressor, missing imputation / collaborative filtering / recommandation systems) that use a Generative (Gaussian) mixture models (probabilistic) fitter fitted using a EM algorithm;</li><li><a href="Imputation.html"><strong><code>BetaML.Imputation</code></strong></a>: Imputation algorithms;</li><li><a href="Utils.html"><strong><code>BetaML.Utils</code>`</strong></a>: Various utility functions (scale, one-hot, distances, kernels, pca, accuracy/error measures..).</li></ul><h3 id="MLJ-interface"><a class="docs-heading-anchor" href="#MLJ-interface">MLJ interface</a><a id="MLJ-interface-1"></a><a class="docs-heading-anchor-permalink" href="#MLJ-interface" title="Permalink"></a></h3><p>BetaML exports the following modules for usage with the <a href="https://github.com/alan-turing-institute/MLJ.jl"><code>MLJ</code></a> toolkit:</p><ul><li>Perceptron models: <code>PerceptronClassifier</code>, <code>KernelPerceptronClassifier</code>, <code>PegasosClassifier</code></li><li>Decision trees/Random forest models:  <code>DecisionTreeClassifier</code>, <code>DecisionTreeRegressor</code>, <code>RandomForestClassifier</code>, <code>RandomForestRegressor</code></li><li>Clustering models and derived models: <code>KMeans</code>, <code>KMedoids</code>, <code>GMMClusterer</code>, <code>MissingImputator</code></li></ul><p>Currently BetaML neural network models are not available in MLJ.</p><h2 id="Quick-examples"><a class="docs-heading-anchor" href="#Quick-examples">Quick examples</a><a id="Quick-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-examples" title="Permalink"></a></h2><p><em>(see the</em> <a href="tutorials/Betaml_tutorial_getting_started.html#getting_started">tutorial</a> <em>for a more step-by-step guide to the examples below and to other examples)</em></p><p>A &quot;V2&quot; API that uses a more uniform <code>fit!(model,X,[Y])</code>, <code>predict(model,X)</code> workflow is currently worked on.</p><ul><li><strong>Using an Artificial Neural Network for multinomial categorisation</strong></li></ul><pre><code class="language-julia hljs"># Load Modules
using BetaML, DelimitedFiles, Random, StatsPlots # Load the main module and ausiliary modules
Random.seed!(123); # Fix the random seed (to obtain reproducible results)

# Load the data
iris     = readdlm(joinpath(dirname(pathof(BetaML)),&quot;..&quot;,&quot;test&quot;,&quot;data&quot;,&quot;iris.csv&quot;),&#39;,&#39;,skipstart=1)
iris     = iris[shuffle(axes(iris, 1)), :] # Shuffle the records, as they aren&#39;t by default
x        = convert(Array{Float64,2}, iris[:,1:4])
y        = map(x-&gt;Dict(&quot;setosa&quot; =&gt; 1, &quot;versicolor&quot; =&gt; 2, &quot;virginica&quot; =&gt;3)[x],iris[:, 5]) # Convert the target column to numbers
y_oh     = oneHotEncoder(y) # Convert to One-hot representation (e.g. 2 =&gt; [0 1 0], 3 =&gt; [0 0 1])

# Split the data in training/testing sets
((xtrain,xtest),(ytrain,ytest),(ytrain_oh,ytest_oh)) = partition([x,y,y_oh],[0.8,0.2],shuffle=false)
(ntrain, ntest) = size.([xtrain,xtest],1)

# Define the Artificial Neural Network model
l1   = DenseLayer(4,10,f=relu) # Activation function is ReLU
l2   = DenseLayer(10,3)        # Activation function is identity by default
l3   = VectorFunctionLayer(3,3,f=softMax) # Add a (parameterless) layer whose activation function (softMax in this case) is defined to all its nodes at once
mynn = buildNetwork([l1,l2,l3],squaredCost,name=&quot;Multinomial logistic regression Model Sepal&quot;) # Build the NN and use the squared cost (aka MSE) as error function

# Training it (default to ADAM)
res = train!(mynn,scale(xtrain),ytrain_oh,epochs=100,batchSize=6) # Use optAlg=SGD (Stochastic Gradient Descent) by default

# Test it
ŷtrain        = predict(mynn,scale(xtrain))   # Note the scaling function
ŷtest         = predict(mynn,scale(xtest))
trainAccuracy = accuracy(ŷtrain,ytrain,tol=1) # 0.983
testAccuracy  = accuracy(ŷtest,ytest,tol=1)   # 1.0

# Visualise results
testSize    = size(ŷtest,1)
ŷtestChosen =  [argmax(ŷtest[i,:]) for i in 1:testSize]
groupedbar([ytest ŷtestChosen], label=[&quot;ytest&quot; &quot;ŷtest (est)&quot;], title=&quot;True vs estimated categories&quot;) # All records correctly labelled !
plot(0:res.epochs,res.ϵ_epochs, ylabel=&quot;epochs&quot;,xlabel=&quot;error&quot;,legend=nothing,title=&quot;Avg. error per epoch on the Sepal dataset&quot;)</code></pre><p><img src="assets/sepalOutput_results.png" alt="results"/></p><p><img src="assets/sepalOutput_errors.png" alt="results"/></p><ul><li><strong>Using the Expectation-Maximisation algorithm for clustering</strong></li></ul><pre><code class="language-julia hljs">using BetaML, DelimitedFiles, Random, StatsPlots # Load the main module and ausiliary modules
Random.seed!(123); # Fix the random seed (to obtain reproducible results)

# Load the data
iris     = readdlm(joinpath(dirname(pathof(BetaML)),&quot;..&quot;,&quot;test&quot;,&quot;data&quot;,&quot;iris.csv&quot;),&#39;,&#39;,skipstart=1)
iris     = iris[shuffle(axes(iris, 1)), :] # Shuffle the records, as they aren&#39;t by default
x        = convert(Array{Float64,2}, iris[:,1:4])
x        = scale(x) # normalise all dimensions to (μ=0, σ=1)
y        = map(x-&gt;Dict(&quot;setosa&quot; =&gt; 1, &quot;versicolor&quot; =&gt; 2, &quot;virginica&quot; =&gt;3)[x],iris[:, 5]) # Convert the target column to numbers

# Get some ranges of minVariance and minCovariance to test
minVarRange   = collect(0.04:0.05:1.5)
minCovarRange = collect(0:0.05:1.45)

# Run the gmm(em) algorithm for the various cases...
sphOut  = [gmm(x,3,mixtures=[SphericalGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE) for v in minVarRange, cv in minCovarRange[1:1]]
diagOut  = [gmm(x,3,mixtures=[DiagonalGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE)  for v in minVarRange, cv in minCovarRange[1:1]]
fullOut = [gmm(x,3,mixtures=[FullGaussian() for i in 1:3],minVariance=v, minCovariance=cv, verbosity=NONE)  for v in minVarRange, cv in minCovarRange]

# Get the Bayesian information criterion (AIC is also available)
sphBIC = [sphOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:1]
diagBIC = [diagOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:1]
fullBIC = [fullOut[v,cv].BIC for v in 1:length(minVarRange), cv in 1:length(minCovarRange)]

# Compare the accuracy with true categories
sphAcc  = [accuracy(sphOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:1]
diagAcc = [accuracy(diagOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:1]
fullAcc = [accuracy(fullOut[v,cv].pₙₖ,y,ignoreLabels=true) for v in 1:length(minVarRange), cv in 1:length(minCovarRange)]

plot(minVarRange,[sphBIC diagBIC fullBIC[:,1] fullBIC[:,15] fullBIC[:,30]], markershape=:circle, label=[&quot;sph&quot; &quot;diag&quot; &quot;full (cov=0)&quot; &quot;full (cov=0.7)&quot; &quot;full (cov=1.45)&quot;], title=&quot;BIC&quot;, xlabel=&quot;minVariance&quot;)
plot(minVarRange,[sphAcc diagAcc fullAcc[:,1] fullAcc[:,15] fullAcc[:,30]], markershape=:circle, label=[&quot;sph&quot; &quot;diag&quot; &quot;full (cov=0)&quot; &quot;full (cov=0.7)&quot; &quot;full (cov=1.45)&quot;], title=&quot;Accuracies&quot;, xlabel=&quot;minVariance&quot;)</code></pre><p><img src="assets/sepalClustersBIC.png" alt="results"/></p><p><img src="assets/sepalClustersAccuracy.png" alt="results"/></p><ul><li><strong>Further examples</strong></li></ul><p>Finally, you may want to give a look at the <a href="https://github.com/sylvaticus/BetaML.jl/tree/master/test">&quot;test&quot; folder</a>. While the primary objective of the scripts under the &quot;test&quot; folder is to provide automatic testing of the BetaML toolkit, they can also be used to see how functions should be called, as virtually all functions provided by BetaML are tested there.</p><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>The development of this package at the <em>Bureau d&#39;Economie Théorique et Appliquée</em> (BETA, Nancy) was supported by the French National Research Agency through the <a href="http://mycor.nancy.inra.fr/ARBRE/">Laboratory of Excellence ARBRE</a>, a part of the “Investissements d&#39;Avenir” Program (ANR 11 – LABX-0002-01).</p><p><a href="hhttp://www.beta-umr7522.fr/"><img src="assets/logos_betaumr.png" alt="BLogos"/></a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/Betaml_tutorial_getting_started.html">Getting started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Thursday 11 August 2022 13:44">Thursday 11 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GMM · BetaML.jl Documentation</title><meta name="title" content="GMM · BetaML.jl Documentation"/><meta property="og:title" content="GMM · BetaML.jl Documentation"/><meta property="twitter:title" content="GMM · BetaML.jl Documentation"/><meta name="description" content="Documentation for BetaML.jl Documentation."/><meta property="og:description" content="Documentation for BetaML.jl Documentation."/><meta property="twitter:description" content="Documentation for BetaML.jl Documentation."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-JYKX8QY5JW"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JYKX8QY5JW', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="BetaML.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">BetaML.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Index</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="tutorials/Betaml_tutorial_getting_started.html">Getting started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Classification - cars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Classification - cars/betaml_tutorial_classification_cars.html">A classification task when labels are known - determining the country of origin of cars given the cars characteristics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Regression - bike sharing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Regression - bike sharing/betaml_tutorial_regression_sharingBikes.html">A regression task: the prediction of  bike  sharing demand</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Clustering - Iris</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Clustering - Iris/betaml_tutorial_cluster_iris.html">A clustering task: the prediction of  plant species from floreal measures (the iris dataset)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Multi-branch neural network</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Multi-branch neural network/betaml_tutorial_multibranch_nn.html">A deep neural network with multi-branch architecture</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Feature importance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="tutorials/Feature importance/Feature_importance.html">Understanding variable importance in black-box machine learning models</a></li></ul></li></ul></li><li><span class="tocitem">API (Reference manual)</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">API V2 (current)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="Api_v2_user.html">Introduction for user</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">For developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="Api_v2_developer.html">API implementation</a></li><li><a class="tocitem" href="StyleGuide_templates.html">Style guide</a></li></ul></li><li><a class="tocitem" href="Api.html">The Api module</a></li></ul></li><li><a class="tocitem" href="Perceptron.html">Perceptron</a></li><li><a class="tocitem" href="Trees.html">Trees</a></li><li><a class="tocitem" href="Nn.html">Nn</a></li><li><a class="tocitem" href="Clustering.html">Clustering</a></li><li class="is-active"><a class="tocitem" href="GMM.html">GMM</a><ul class="internal"><li><a class="tocitem" href="#Module-Index"><span>Module Index</span></a></li><li><a class="tocitem" href="#Detailed-API"><span>Detailed API</span></a></li></ul></li><li><a class="tocitem" href="Imputation.html">Imputation</a></li><li><a class="tocitem" href="Utils.html">Utils</a></li></ul></li><li><a class="tocitem" href="MLJ_interface.html">MLJ interface</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API (Reference manual)</a></li><li class="is-active"><a href="GMM.html">GMM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="GMM.html">GMM</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sylvaticus/BetaML.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sylvaticus/BetaML.jl/blob/master/docs/src/GMM.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="gmm_module"><a class="docs-heading-anchor" href="#gmm_module">The BetaML.GMM Module</a><a id="gmm_module-1"></a><a class="docs-heading-anchor-permalink" href="#gmm_module" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM" href="#BetaML.GMM"><code>BetaML.GMM</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GMM module</code></pre><p>Generative (Gaussian) Mixed Model learners (supervised/unsupervised)</p><p>Provides clustering and regressors using  (Generative) Gaussiam Mixture Model (probabilistic).</p><p>Collaborative filtering / missing values imputation / reccomendation systems based on GMM is available in the <code>Imputation</code> module.</p><p>The module provides the following models. Use <code>?[model]</code> to access their documentation:</p><ul><li><a href="GMM.html#BetaML.GMM.GaussianMixtureClusterer"><code>GaussianMixtureClusterer</code></a>: soft-clustering using GMM</li><li><a href="GMM.html#BetaML.GMM.GaussianMixtureRegressor2"><code>GaussianMixtureRegressor2</code></a>: regressor using GMM as back-end (first algorithm)</li><li><a href="GMM.html#BetaML.GMM.GaussianMixtureRegressor2"><code>GaussianMixtureRegressor2</code></a>: regressor using GMM as back-end (second algorithm)</li></ul><p>All the algorithms works with arbitrary mixture distribution, altought only {Spherical|Diagonal|Full} Gaussian mixtures has been implemented. User defined mixtures can be used defining a struct as subtype of <code>AbstractMixture</code> and implementing for that mixture the following functions:</p><ul><li><code>init_mixtures!(mixtures, X; minimum_variance, minimum_covariance, initialisation_strategy)</code></li><li><code>lpdf(m,x,mask)</code> (for the e-step)</li><li><code>update_parameters!(mixtures, X, pₙₖ; minimum_variance, minimum_covariance)</code> (the m-step)</li><li><code>npar(mixtures::Array{T,1})</code> (for the BIC/AIC computation)</li></ul><p>All the GMM-based algorithms works only with numerical data, but accepts also Missing one.</p><p>The <code>GaussianMixtureClusterer</code> algorithm reports the <code>BIC</code> and the <code>AIC</code> in its <code>info(model)</code>, but some metrics of the clustered output are also available, for example the <a href="Utils.html#BetaML.Utils.silhouette-Tuple{Any, Any}"><code>silhouette</code></a> score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/GMM.jl#L3-L28">source</a></section></article><h2 id="Module-Index"><a class="docs-heading-anchor" href="#Module-Index">Module Index</a><a id="Module-Index-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Index" title="Permalink"></a></h2><ul><li><a href="GMM.html#BetaML.GMM.init_mixtures!-Union{Tuple{T}, Tuple{Vector{T}, Any}} where T&lt;:BetaML.GMM.AbstractGaussian"><code>BetaML.GMM.init_mixtures!</code></a></li><li><a href="GMM.html#BetaML.GMM.lpdf-Tuple{SphericalGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a></li><li><a href="GMM.html#BetaML.GMM.lpdf-Tuple{FullGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a></li><li><a href="GMM.html#BetaML.GMM.lpdf-Tuple{DiagonalGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a></li><li><a href="GMM.html#BetaML.GMM.DiagonalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Vector{T}}}} where T"><code>BetaML.GMM.DiagonalGaussian</code></a></li><li><a href="GMM.html#BetaML.GMM.FullGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Matrix{T}}}} where T"><code>BetaML.GMM.FullGaussian</code></a></li><li><a href="GMM.html#BetaML.GMM.GaussianMixtureClusterer"><code>BetaML.GMM.GaussianMixtureClusterer</code></a></li><li><a href="GMM.html#BetaML.GMM.GaussianMixtureRegressor"><code>BetaML.GMM.GaussianMixtureRegressor</code></a></li><li><a href="GMM.html#BetaML.GMM.GaussianMixtureRegressor2"><code>BetaML.GMM.GaussianMixtureRegressor2</code></a></li><li><a href="GMM.html#BetaML.GMM.GaussianMixture_hp"><code>BetaML.GMM.GaussianMixture_hp</code></a></li><li><a href="GMM.html#BetaML.GMM.SphericalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, T}}} where T"><code>BetaML.GMM.SphericalGaussian</code></a></li></ul><h2 id="Detailed-API"><a class="docs-heading-anchor" href="#Detailed-API">Detailed API</a><a id="Detailed-API-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.DiagonalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Vector{T}}}} where T" href="#BetaML.GMM.DiagonalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Vector{T}}}} where T"><code>BetaML.GMM.DiagonalGaussian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiagonalGaussian(
    μ::Union{Nothing, Array{T, 1}}
) -&gt; DiagonalGaussian
DiagonalGaussian(
    μ::Union{Nothing, Array{T, 1}},
    σ²::Union{Nothing, Array{T, 1}}
) -&gt; DiagonalGaussian
</code></pre><p>DiagonalGaussian(μ,σ²) - Gaussian mixture with mean μ and variances σ² (and fixed zero covariances)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L33-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.FullGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Matrix{T}}}} where T" href="#BetaML.GMM.FullGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, Matrix{T}}}} where T"><code>BetaML.GMM.FullGaussian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FullGaussian(μ::Union{Nothing, Array{T, 1}}) -&gt; FullGaussian
FullGaussian(
    μ::Union{Nothing, Array{T, 1}},
    σ²::Union{Nothing, Array{T, 2}}
) -&gt; FullGaussian
</code></pre><p>FullGaussian(μ,σ²) - Gaussian mixture with mean μ and variance/covariance matrix σ²</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.GaussianMixtureClusterer" href="#BetaML.GMM.GaussianMixtureClusterer"><code>BetaML.GMM.GaussianMixtureClusterer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct GaussianMixtureClusterer &lt;: BetaMLUnsupervisedModel</code></pre><p>Assign class probabilities to records (i.e. <em>soft</em> clustering) assuming a probabilistic generative model of observed data using mixtures.</p><p>For the parameters see <a href="GMM.html#BetaML.GMM.GaussianMixture_hp"><code>?GaussianMixture_hp</code></a> and <a href="Api.html#BetaML.Api.BML_options"><code>?BML_options</code></a>.</p><p><strong>Notes:</strong></p><ul><li>Data must be numerical</li><li>Mixtures can be user defined: see the <a href="GMM.html#BetaML.GMM"><code>?GMM</code></a> module documentation for a discussion on provided vs custom mixtures.</li><li>Online fitting (re-fitting with new data) is supported by setting the old learned mixtrures as the starting values</li><li>The model is fitted using an Expectation-Minimisation (EM) algorithm that supports Missing data and is implemented in the log-domain for better numerical accuracy with many dimensions</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs">julia&gt; using BetaML

julia&gt; X = [1.1 10.1; 0.9 9.8; 10.0 1.1; 12.1 0.8; 0.8 9.8];

julia&gt; mod = GaussianMixtureClusterer(n_classes=2)
GaussianMixtureClusterer - A Generative Mixture Model (unfitted)

julia&gt; prob_belong_classes = fit!(mod,X)
Iter. 1:        Var. of the post  2.15612140465882        Log-likelihood -29.06452054772657
5×2 Matrix{Float64}:
 1.0  0.0
 1.0  0.0
 0.0  1.0
 0.0  1.0
 1.0  0.0

julia&gt; new_probs = fit!(mod,[11 0.9])
Iter. 1:        Var. of the post  1.0     Log-likelihood -1.3312256125240092
1×2 Matrix{Float64}:
 0.0  1.0

julia&gt; info(mod)
Dict{String, Any} with 6 entries:
  &quot;xndims&quot;         =&gt; 2
  &quot;error&quot;          =&gt; [1.0, 0.0, 0.0]
  &quot;AIC&quot;            =&gt; 15.7843
  &quot;fitted_records&quot; =&gt; 6
  &quot;lL&quot;             =&gt; 1.10786
  &quot;BIC&quot;            =&gt; -2.21571

julia&gt; parameters(mod)
BetaML.GMM.GMMCluster_lp (a BetaMLLearnableParametersSet struct)
- mixtures: DiagonalGaussian{Float64}[DiagonalGaussian{Float64}([0.9333333333333332, 9.9], [0.05, 0.05]), DiagonalGaussian{Float64}([11.05, 0.9500000000000001], [0.05, 0.05])]
- initial_probmixtures: [0.0, 1.0]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/GMM_clustering.jl#L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.GaussianMixtureRegressor" href="#BetaML.GMM.GaussianMixtureRegressor"><code>BetaML.GMM.GaussianMixtureRegressor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct GaussianMixtureRegressor &lt;: BetaMLUnsupervisedModel</code></pre><p>A multi-dimensional, missing data friendly non-linear regressor based on Generative (Gaussian) Mixture Model.</p><p>The training data is used to fit a probabilistic model with latent mixtures (Gaussian distributions with different covariances are already implemented) and then predictions of new data is obtained by fitting the new data to the mixtures.</p><p>For hyperparameters see <a href="GMM.html#BetaML.GMM.GaussianMixture_hp"><code>GaussianMixture_hp</code></a> and <a href="Api.html#BetaML.Api.BML_options"><code>BML_options</code></a>.</p><p>Thsi strategy (<code>GaussianMixtureRegressor</code>) works by training the EM algorithm on a combined (hcat) matrix of X and Y. At predict time, the new data is first fitted to the learned mixtures using the e-step part of the EM algorithm (and using missing values for the dimensions belonging to Y) to obtain the probabilistic assignment of each record to the various mixtures. Then these probabilities are multiplied to the mixture averages for the Y dimensions to obtain the predicted value(s) for each record. </p><p><strong>Example:</strong></p><pre><code class="language-julia hljs">julia&gt; using BetaML

julia&gt; X = [1.1 10.1; 0.9 9.8; 10.0 1.1; 12.1 0.8; 0.8 9.8];

julia&gt; Y = X[:,1] .* 2 - X[:,2]
5-element Vector{Float64}:
 -7.8999999999999995
 -8.0
 18.9
 23.4
 -8.200000000000001

julia&gt; mod = GaussianMixtureRegressor(n_classes=2)
GaussianMixtureRegressor - A regressor based on Generative Mixture Model (unfitted)

julia&gt; ŷ = fit!(mod,X,Y)
Iter. 1:        Var. of the post  2.2191120060614065      Log-likelihood -47.70971887023561
5×1 Matrix{Float64}:
 -8.033333333333333
 -8.033333333333333
 21.15
 21.15
 -8.033333333333333

julia&gt; new_probs = predict(mod,[11 0.9])
1×1 Matrix{Float64}:
 21.15

julia&gt; info(mod)
Dict{String, Any} with 6 entries:
  &quot;xndims&quot;         =&gt; 3
  &quot;error&quot;          =&gt; [2.21911, 0.0260833, 3.19141e-39, 0.0]
  &quot;AIC&quot;            =&gt; 60.0684
  &quot;fitted_records&quot; =&gt; 5
  &quot;lL&quot;             =&gt; -17.0342
  &quot;BIC&quot;            =&gt; 54.9911

julia&gt; parameters(mod)
BetaML.GMM.GMMCluster_lp (a BetaMLLearnableParametersSet struct)
- mixtures: DiagonalGaussian{Float64}[DiagonalGaussian{Float64}([0.9333333333333332, 9.9, -8.033333333333333], [1.1024999999999996, 0.05, 5.0625]), DiagonalGaussian{Float64}([11.05, 0.9500000000000001, 21.15], [1.1024999999999996, 0.05, 5.0625])]
- initial_probmixtures: [0.6, 0.4]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/GMM_regression.jl#L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.GaussianMixtureRegressor2" href="#BetaML.GMM.GaussianMixtureRegressor2"><code>BetaML.GMM.GaussianMixtureRegressor2</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct GaussianMixtureRegressor2 &lt;: BetaMLUnsupervisedModel</code></pre><p>A multi-dimensional, missing data friendly non-linear regressor based on Generative (Gaussian) Mixture Model (strategy &quot;1&quot;).</p><p>The training data is used to fit a probabilistic model with latent mixtures (Gaussian distributions with different covariances are already implemented) and then predictions of new data is obtained by fitting the new data to the mixtures.</p><p>For hyperparameters see <a href="GMM.html#BetaML.GMM.GaussianMixture_hp"><code>GaussianMixture_hp</code></a> and <a href="Api.html#BetaML.Api.BML_options"><code>BML_options</code></a>.</p><p>This strategy (<code>GaussianMixtureRegressor2</code>) works by fitting the EM algorithm on the feature matrix X. Once the data has been probabilistically assigned to the various classes, a mean value of fitting values Y is computed for each cluster (using the probabilities as weigths). At predict time, the new data is first fitted to the learned mixtures using the e-step part of the EM algorithm to obtain the probabilistic assignment of each record to the various mixtures. Then these probabilities are multiplied to the mixture averages for the Y dimensions learned at training time to obtain the predicted value(s) for each record. </p><p><strong>Notes:</strong></p><ul><li>Predicted values are always a matrix, even when a single variable is predicted (use <code>dropdims(ŷ,dims=2)</code> to get a single vector).</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs">julia&gt; using BetaML

julia&gt; X = [1.1 10.1; 0.9 9.8; 10.0 1.1; 12.1 0.8; 0.8 9.8];

julia&gt; Y = X[:,1] .* 2 - X[:,2]
5-element Vector{Float64}:
 -7.8999999999999995
 -8.0
 18.9
 23.4
 -8.200000000000001

julia&gt; mod = GaussianMixtureRegressor2(n_classes=2)
GaussianMixtureRegressor2 - A regressor based on Generative Mixture Model (unfitted)

julia&gt; ŷ = fit!(mod,X,Y)
Iter. 1:        Var. of the post  2.15612140465882        Log-likelihood -29.06452054772657
5×1 Matrix{Float64}:
 -8.033333333333333
 -8.033333333333333
 21.15
 21.15
 -8.033333333333333

julia&gt; new_probs = predict(mod,[11 0.9])
1×1 Matrix{Float64}:
 21.15

julia&gt; info(mod)
Dict{String, Any} with 6 entries:
  &quot;xndims&quot;         =&gt; 2
  &quot;error&quot;          =&gt; [2.15612, 0.118848, 4.19495e-7, 0.0, 0.0]
  &quot;AIC&quot;            =&gt; 32.7605
  &quot;fitted_records&quot; =&gt; 5
  &quot;lL&quot;             =&gt; -7.38023
  &quot;BIC&quot;            =&gt; 29.2454</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/GMM_regression.jl#L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.GaussianMixture_hp" href="#BetaML.GMM.GaussianMixture_hp"><code>BetaML.GMM.GaussianMixture_hp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct GaussianMixture_hp &lt;: BetaMLHyperParametersSet</code></pre><p>Hyperparameters for GMM clusters and other GMM-based algorithms</p><p><strong>Parameters:</strong></p><ul><li><p><code>n_classes</code>: Number of mixtures (latent classes) to consider [def: 3]</p></li><li><p><code>initial_probmixtures</code>: Initial probabilities of the categorical distribution (n_classes x 1) [default: <code>[]</code>]</p></li><li><p><code>mixtures</code>: An array (of length <code>n_classes</code>) of the mixtures to employ (see the <a href="GMM.html#BetaML.GMM"><code>?GMM</code></a> module). Each mixture object can be provided with or without its parameters (e.g. mean and variance for the gaussian ones). Fully qualified mixtures are useful only if the <code>initialisation_strategy</code> parameter is  set to &quot;gived&quot;. This parameter can also be given symply in term of a <em>type</em>. In this case it is automatically extended to a vector of <code>n_classes</code> mixtures of the specified type. Note that mixing of different mixture types is not currently supported and that currently implemented mixtures are <code>SphericalGaussian</code>, <code>DiagonalGaussian</code> and <code>FullGaussian</code>. [def: <code>DiagonalGaussian</code>]</p></li><li><p><code>tol</code>: Tolerance to stop the algorithm [default: 10^(-6)]</p></li><li><p><code>minimum_variance</code>: Minimum variance for the mixtures [default: 0.05]</p></li><li><p><code>minimum_covariance</code>: Minimum covariance for the mixtures with full covariance matrix [default: 0]. This should be set different than minimum_variance.</p></li><li><p><code>initialisation_strategy</code>: The computation method of the vector of the initial mixtures. One of the following:</p><ul><li>&quot;grid&quot;: using a grid approach</li><li>&quot;given&quot;: using the mixture provided in the fully qualified <code>mixtures</code> parameter</li><li>&quot;kmeans&quot;: use first kmeans (itself initialised with a &quot;grid&quot; strategy) to set the initial mixture centers [default]</li></ul><p>Note that currently &quot;random&quot; and &quot;shuffle&quot; initialisations are not supported in gmm-based algorithms.</p></li></ul><ul><li><p><code>maximum_iterations</code>: Maximum number of iterations [def: 5000]</p></li><li><p><code>tunemethod</code>: The method - and its parameters - to employ for hyperparameters autotuning. See <a href="Utils.html#BetaML.Utils.SuccessiveHalvingSearch"><code>SuccessiveHalvingSearch</code></a> for the default method (suitable for the GMM-based regressors) To implement automatic hyperparameter tuning during the (first) <code>fit!</code> call simply set <code>autotune=true</code> and eventually change the default <code>tunemethod</code> options (including the parameter ranges, the resources to employ and the loss function to adopt).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/GMM_clustering.jl#L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.SphericalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, T}}} where T" href="#BetaML.GMM.SphericalGaussian-Union{Tuple{Union{Nothing, Vector{T}}}, Tuple{T}, Tuple{Union{Nothing, Vector{T}}, Union{Nothing, T}}} where T"><code>BetaML.GMM.SphericalGaussian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SphericalGaussian(
    μ::Union{Nothing, Array{T, 1}}
) -&gt; SphericalGaussian
SphericalGaussian(
    μ::Union{Nothing, Array{T, 1}},
    σ²::Union{Nothing, T} where T
) -&gt; SphericalGaussian
</code></pre><p>SphericalGaussian(μ,σ²) - Spherical Gaussian mixture with mean μ and (single) variance σ²</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.init_mixtures!-Union{Tuple{T}, Tuple{Vector{T}, Any}} where T&lt;:BetaML.GMM.AbstractGaussian" href="#BetaML.GMM.init_mixtures!-Union{Tuple{T}, Tuple{Vector{T}, Any}} where T&lt;:BetaML.GMM.AbstractGaussian"><code>BetaML.GMM.init_mixtures!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_mixtures!(mixtures::Array{T,1}, X; minimum_variance=0.25, minimum_covariance=0.0, initialisation_strategy=&quot;grid&quot;,rng=Random.GLOBAL_RNG)</code></pre><p>The parameter <code>initialisation_strategy</code> can be <code>grid</code>, <code>kmeans</code> or <code>given</code>:</p><ul><li><code>grid</code>: Uniformly cover the space observed by the data</li><li><code>kmeans</code>: Use the kmeans algorithm. If the data contains missing values, a first run of <code>predictMissing</code> is done under init=<code>grid</code> to impute the missing values just to allow the kmeans algorithm. Then the em algorithm is used with the output of kmean as init values.</li><li><code>given</code>: Leave the provided set of initial mixtures</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L113-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.lpdf-Tuple{DiagonalGaussian, Any, Any}" href="#BetaML.GMM.lpdf-Tuple{DiagonalGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>lpdf(m::DiagonalGaussian,x,mask) - Log PDF of the mixture given the observation <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.lpdf-Tuple{FullGaussian, Any, Any}" href="#BetaML.GMM.lpdf-Tuple{FullGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>lpdf(m::FullGaussian,x,mask) - Log PDF of the mixture given the observation <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BetaML.GMM.lpdf-Tuple{SphericalGaussian, Any, Any}" href="#BetaML.GMM.lpdf-Tuple{SphericalGaussian, Any, Any}"><code>BetaML.GMM.lpdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>lpdf(m::SphericalGaussian,x,mask) - Log PDF of the mixture given the observation <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sylvaticus/BetaML.jl/blob/b20bbf632b7dbd268a5c5613a4f920a07f4741b4/src/GMM/Mixtures.jl#L204">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="Clustering.html">« Clustering</a><a class="docs-footer-nextpage" href="Imputation.html">Imputation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 12:23">Thursday 5 June 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
